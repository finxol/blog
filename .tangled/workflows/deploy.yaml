when:
    - event: ["push", "pull_request"]
      branch: ["main"]

dependencies:
    nixpkgs:
        - deno
        - nodejs
        - pnpm

steps:
    - name: Install dependencies
      command: |
          pnpm install

    - name: Generate static site
      command: |
          pnpm generate

    - name: Install deployctl
      command: |
          deno install -gArf jsr:@deno/deployctl

    - name: Deploy to Deno Deploy
      command: |
          cd blog
          deployctl deploy --project finxol-blog --entrypoint jsr:@std/http/file-server --include=. --prod
